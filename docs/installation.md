# Установка Shiptest

<details>
<summary> Содержание</summary>

- [Скачивание](#скачивание-кода)
- [Установка](#установка)
- [Конфигурация](#конфигурация)
- [Вебхуки](#вебхуки)
- [Обновление](#обновление)
- [База данных](#установка-базы-данных)

</details>

### Скачивание кода

Самый простой способ получить код - использовать GitHub функцию скачивания `.zip`.

Нажми [сюда](https://github.com/CeladonSS13/Shiptest/archive/refs/heads/alpha-stable.zip) чтобы получить последнюю версию кода в виде .zip файла, а затем разархивируй его куда захочешь.

Более сложный в скачивании, но более простой в обновлении метод - использование git. Тебе нужно скачать git или клиент [отсюда](http://git-scm.com/). Когда он установится, нажми правой кнопкой мыши в любой папке правую кнопку мыши и выбери "Git Bash". Когда окно откроется, пиши в него:

```sh
git clone https://github.com/CeladonSS13/Shiptest.git
```

(Подсказка: чтобы вставить в git bash можно нажать ПКМ по окну, или использовать <kbd>Ctrl</kbd>+<kbd>Insert</kbd>)

Загрузка займет некоторое время, но обновлять билд будет проще.

---

### Установка

Первая установка должна быть довольно простой. Во-первых, тебе надо установить BYOND. Его можно скачать [здесь](http://www.byond.com/).

Ты скачал только исходный код, поэтому его нужно скомпилировать. Открой `shiptest.dme` двойным кликом, слева сверху выбери вкладку `Build` и там нажми `Compile`. Не пугайся того что почти ничего в консоли долго не происходит, просто жди, это нормально. Это займёт время, но по итогу внизу ты должен увидеть такое сообщение:
```
saving shiptest.dmb (DEBUG mode)

shiptest.dmb - 0 errors, 0 warnings
```

Если ты видишь какие-то ошибки или предупреждения - что-то однозначно пошло не по плану. Скорее всего либо повреждена загрузка, либо файлы извлечены неправильно, либо мы допустили ошибку в коде. Спросить можно в дискорде, указанном в [`README`](/README.md)

---

### Конфигурация

Отредактируй `config.txt`, чтобы установить вероятности для различных режимов игры в режиме "Secret" или указать адрес вашего сервера таким образом, чтобы все ваши игроки не отключались в конце каждого раунда. Не рекомендуется включать игровые режимы с вероятностью 0, ибо в них могут быть различные проблемы и эти режимы в настоящее время не тестируются - повсюду могут быть неизвестные и неестественные ошибки.

Отредактируй `admins.txt` чтобы удалить администраторов по умолчанию и добавить своих собственных. "Host" это самый высокий уровень доступа. Также, рекомендуемые уровни администратора - "Admin" и "Moderator".  Формат ввода:
```
byondkey = Rank
```
Сикей должен быть в нижнем регистре, а в ранге администратора заглавные буквы должны быть правильно указаны. Есть еще несколько рангов администратора, но этих двух должно быть достаточно для большинства серверов, при условии, что у тебя есть заслуживающие доверия администраторы. Ранги можн поссмотреть в файле `admin_ranks.txt`

Чтобы запустить сервер, запусти Dream Daemon и введи путь к твоему скомпилированному `shiptest.dmb` файлу.  Убедись, что ты выставил порт, который указан в `config.txt`, а также установи в ячейке "Security" значение 'Trusted', чтобы не приходилось подтверждать доступ к каждому отдельному файлу конфигурации и данных сервера. Затем просто жми GO, и сервер должен запуститься, готовым к подключению.

Есть второй способ запустить билд, для этого надо чтобы у тебя был Visual Studio Code (сокращенно VSC или ВСК). Запускаешь VSC, открываешь папку с билдом, где находится `shiptest.dmb` и, после проверок, нажимаешь клавишу F5. Возможно понадобятся расширения для ВСК, чтобы все запустилось.
---

### Обновление

Перед обновлением, лучше всего создать резервную копию папок `/config` и `/data`, так как в них хранятся конфигурация вашего сервера, предпочтения игроков и банлист.

Если ты использовал метод `zip`, то тебе нужно снова [скачать zip-файл](https://github.com/CeladonSS13/Shiptest/archive/refs/heads/alpha-stable.zip) и распаковать его в другом месте, а затем скопировать туда папки `/config` и `/data`.

Если ты использовал метод git, нужно просто ввести это в git bash:
```sh
git pull
```

Когда команда выполнится, скопируй поверх твоих `/data` и `/config` резервно скопированные папки, на всякий случай.

После этого нужно лишь вновь скомпилировать код и всё должно работать прекрасно.

---

### Установка базы данных

Серверная часть для SQL `/library/stats` и банов требуют наличие MySQL сервера. Конфигурация сведений о сервере находится в `/config/dbconfig.txt`.
